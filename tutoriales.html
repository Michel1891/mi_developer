<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutoriales del Sistema de Alarmas</title>

<style>
body{
  background:#034164b9;
  margin:0;
  font-family:Arial,sans-serif;
  color:#fff;
  padding-top:100px;
}

/* HEADER */
header{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  background:rgba(3,65,100,.95);
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px 20px;
  z-index:1000;
}
.header-left{display:flex;align-items:center;gap:15px}
.logo-header{width:50px;border-radius:50%}
.user-avatar{width:45px;border-radius:50%;border:2px solid #00b4d8}
#btnLogout{background:#00b4d8;color:#fff;border:none;border-radius:6px;padding:8px 14px}

/* PANEL */
.container{
  background:rgba(53,47,47,.75);
  max-width:360px;
  margin:20px auto;
  padding:40px;
  border-radius:15px;
  box-shadow:0 0 20px #fff;
  text-align:center;
}
.logo{width:240px;margin-bottom:15px}
button{
  background:#00b4d8;
  color:#fff;
  padding:10px 15px;
  border:none;
  border-radius:6px;
  margin:10px;
  cursor:pointer;
}
.bloqueado{
  display:none;
  background:rgba(0,0,0,.7);
  padding:15px;
  border-radius:10px;
  color:#ff7777;
}

/* BOTONERA */
.botonera{
  max-width:450px;
  margin:30px auto;
  padding:25px;
  background:rgba(53,47,47,.75);
  border-radius:15px;
  box-shadow:0 0 20px #fff;
  display:none;
}
.botonera button{
  width:100%;
  margin:8px 0;
}
</style>
</head>

<body>

<header>
  <div class="header-left">
    <img src="src/image/logo4.png" class="logo-header">
    <h2>Tutoriales Premium</h2>
  </div>
  <div>
    <img src="src/image/default-user.png" class="user-avatar">
    <button id="btnLogout">Salir</button>
  </div>
</header>

<div class="container">
  <img src="src/image/logo4.png" class="logo">
  <h2>Panel de acceso</h2>
  <button id="btnIngresar">ğŸšª Ingresar</button>

  <div id="bloqueo" class="bloqueado">
    âš ï¸ SuscripciÃ³n requerida<br><br>
    <a style="color:#00b4d8"
       href="https://www.mercadopago.com.uy/subscriptions/checkout?preapproval_plan_id=80b9657a5e7040b794c98f5d55ce4a6e">
       Activar suscripciÃ³n
    </a>
  </div>
</div>

<!-- ğŸ”˜ BOTONERA -->
<div class="botonera" id="botonera">
  <button onclick="navegar('dsc1832.html')">ğŸ”§ DSC 1616 / 1832 / 1864</button>
  <button onclick="navegar('tutoriales.html')">ğŸ”§Paradox 5500/6000/7000</button>
  <button onclick="navegar('manualix.html')">ğŸ”§Ademco 21/48</button>
  <button onclick="navegar('sobre.html')">ğŸ”§Paradox evo 48</button>
  <button onclick="navegar('dsc1832.html')">ğŸ”§ Neo 2016/2032</button>
  <button onclick="navegar('tutoriales.html')">ğŸ”§Qsys y Ajax</button>
  <button onclick="navegar('manualix.html')">ğŸ”§Manuales de CCTV</button>
  <button onclick="navegar('sobre.html')">ğŸ”§Manuales CaddX NX8</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

/* FIREBASE */
const firebaseConfig={
  apiKey:"AIzaSyB_0_PIpdto8u1touBZNVoHiago6M2akoc",
  authDomain:"manualix-1d0fc.firebaseapp.com",
  projectId:"manualix-1d0fc",
  messagingSenderId:"847110946549",
  appId:"1:847110946549:web:0a507851fef1d9df6ccfbc"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

let accesoPermitido=false;

const bloqueo=document.getElementById("bloqueo");
const botonera=document.getElementById("botonera");

/* INGRESAR */
document.getElementById("btnIngresar").onclick=async()=>{
  const user=auth.currentUser;
  if(!user) return;

  const snap=await getDoc(doc(db,"suscripciones",user.email));
  if(snap.exists() && snap.data().activa===true){
    accesoPermitido=true;
    bloqueo.style.display="none";
    botonera.style.display="block";
  }else{
    accesoPermitido=false;
    bloqueo.style.display="block";
    botonera.style.display="none";
  }
};

/* NAVEGACIÃ“N PROTEGIDA */
window.navegar=(url)=>{
  if(!accesoPermitido){
    alert("Acceso denegado. SuscripciÃ³n requerida.");
    return;
  }
  window.location.href=url;
};

/* AUTO VALIDAR */
onAuthStateChanged(auth, async(user)=>{
  if(!user) return;
  const snap=await getDoc(doc(db,"suscripciones",user.email));
  if(snap.exists() && snap.data().activa===true){
    accesoPermitido=true;
    botonera.style.display="block";
  }
});

/* LOGOUT */
document.getElementById("btnLogout").onclick=async()=>{
  await signOut(auth);
  location.reload();
};
</script>

</body>
</html>




